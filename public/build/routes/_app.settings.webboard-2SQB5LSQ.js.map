{
  "version": 3,
  "sources": ["../../../app/routes/_app.settings.webboard.tsx"],
  "sourcesContent": ["import { useContext, useEffect, useState } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport { useFetcher, useSubmit } from \"@remix-run/react\";\nimport { Result, Space, Typography } from \"antd\";\nimport { LoadingOutlined } from \"@ant-design/icons\";\nimport { TextEditor, TiltButton } from \"~/components/common\";\nimport { AuthContext } from \"~/contexts\";\nimport { json, type ActionFunction } from \"@remix-run/node\";\nimport { commitSession, getSessionFromRequest } from \"~/session.server\";\nimport * as APIServer from \"~/api\";\nconst { Text, Title } = Typography;\n\nexport const action: ActionFunction = async ({ request }) => {\n  const session = await getSessionFromRequest(request);\n  const formdata = await request.formData();\n  const entries = Object.fromEntries(formdata);\n\n  try {\n    await APIServer.clientFromSession(session).request(\n      APIServer.updateSignature(entries)\n    );\n    const { data } = await APIServer.clientFromSession(session).request(\n      APIServer.me()\n    );\n    session.set(\"me\", data);\n    session.flash(\"flashMessage\", {\n      type: \"success\",\n      message: `successfully update signature`,\n    });\n  } catch (e: any) {\n    session.flash(\"flashMessage\", {\n      type: \"error\",\n      message:\n        e.errors && e.errors.length > 1 ? e.errors[0] : e.response.data.message,\n    });\n  }\n\n  return json(null, {\n    headers: {\n      \"Set-Cookie\": await commitSession(session),\n    },\n  });\n};\n\nexport default function SettingsWebboard() {\n  const { t } = useTranslation();\n  const fetcher = useFetcher();\n  const { user } = useContext(AuthContext);\n  const [loading, setLoading] = useState(true);\n  const [content, setContent] = useState<any>(\"\");\n  const submit = useSubmit();\n\n  const onSubmit = () => {\n    submit(\n      {\n        signature: content,\n      },\n      { method: \"post\" }\n    );\n  };\n\n  useEffect(() => {\n    setLoading(false);\n  }, []);\n\n  return (\n    <div style={{ maxWidth: 600 }}>\n      <Space size={10} direction=\"vertical\" style={{ marginBottom: 20 }}>\n        <Title level={2} style={{ margin: 0 }}>\n          {t(\"webboard\")}\n        </Title>\n        <Text>{t(\"signature\")}</Text>\n      </Space>\n      <Space direction=\"vertical\" size={20} style={{ display: \"flex\" }}>\n        {!loading ? (\n          <TextEditor\n            id=\"signature\"\n            initialValues={user.signature && user.signature}\n            fetcher={fetcher}\n            onChange={setContent}\n          />\n        ) : (\n          <Result icon={<LoadingOutlined style={{ fontSize: 24 }} spin />} />\n        )}\n        <TiltButton\n          color=\"primary\"\n          onClick={onSubmit}\n          style={{ marginTop: 20 }}\n        >\n          {t(\"save\")}\n        </TiltButton>\n      </Space>\n    </div>\n  );\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,mBAAgD;AAOhD,kBAA0C;AAC1C,qBAAqD;AA4D7C;AA1DR,IAAM,EAAE,MAAM,MAAM,IAAI;AAkCT,SAAR,mBAAoC;AACzC,QAAM,EAAE,EAAE,IAAI,eAAe;AAC7B,QAAM,UAAU,WAAW;AAC3B,QAAM,EAAE,KAAK,QAAI,yBAAW,WAAW;AACvC,QAAM,CAAC,SAAS,UAAU,QAAI,uBAAS,IAAI;AAC3C,QAAM,CAAC,SAAS,UAAU,QAAI,uBAAc,EAAE;AAC9C,QAAM,SAAS,UAAU;AAEzB,QAAM,WAAW,MAAM;AACrB;AAAA,MACE;AAAA,QACE,WAAW;AAAA,MACb;AAAA,MACA,EAAE,QAAQ,OAAO;AAAA,IACnB;AAAA,EACF;AAEA,8BAAU,MAAM;AACd,eAAW,KAAK;AAAA,EAClB,GAAG,CAAC,CAAC;AAEL,SACE,mDAAC,SAAI,OAAO,EAAE,UAAU,IAAI,GAC1B;AAAA,uDAAC,iBAAM,MAAM,IAAI,WAAU,YAAW,OAAO,EAAE,cAAc,GAAG,GAC9D;AAAA,yDAAC,SAAM,OAAO,GAAG,OAAO,EAAE,QAAQ,EAAE,GACjC,YAAE,UAAU,KADf;AAAA;AAAA;AAAA;AAAA,aAEA;AAAA,MACA,mDAAC,QAAM,YAAE,WAAW,KAApB;AAAA;AAAA;AAAA;AAAA,aAAsB;AAAA,SAJxB;AAAA;AAAA;AAAA;AAAA,WAKA;AAAA,IACA,mDAAC,iBAAM,WAAU,YAAW,MAAM,IAAI,OAAO,EAAE,SAAS,OAAO,GAC5D;AAAA,OAAC,UACA;AAAA,QAAC;AAAA;AAAA,UACC,IAAG;AAAA,UACH,eAAe,KAAK,aAAa,KAAK;AAAA,UACtC;AAAA,UACA,UAAU;AAAA;AAAA,QAJZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAKA,IAEA,mDAAC,kBAAO,MAAM,mDAAC,2BAAgB,OAAO,EAAE,UAAU,GAAG,GAAG,MAAI,QAA9C;AAAA;AAAA;AAAA;AAAA,aAA+C,KAA7D;AAAA;AAAA;AAAA;AAAA,aAAiE;AAAA,MAEnE;AAAA,QAAC;AAAA;AAAA,UACC,OAAM;AAAA,UACN,SAAS;AAAA,UACT,OAAO,EAAE,WAAW,GAAG;AAAA,UAEtB,YAAE,MAAM;AAAA;AAAA,QALX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAMA;AAAA,SAjBF;AAAA;AAAA;AAAA;AAAA,WAkBA;AAAA,OAzBF;AAAA;AAAA;AAAA;AAAA,SA0BA;AAEJ;",
  "names": []
}
